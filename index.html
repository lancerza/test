<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Custom UI Player</title>
    <link rel="icon" href="data:;base64,=">
    <style>
        body { margin: 0; padding: 0; background: #121212; color: #e0e0e0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .container { width: 95%; max-width: 1200px; margin: 20px auto; }
        
        /* Custom Player Styles */
        .player-wrapper { position: relative; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); }
        video { width: 100%; display: block; }
        .custom-controls { position: absolute; bottom: 0; left: 0; right: 0; padding: 10px; display: flex; align-items: center; gap: 15px; background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%); opacity: 0; transition: opacity 0.3s ease; }
        .player-wrapper:hover .custom-controls { opacity: 1; }
        .control-btn { background: none; border: none; color: white; cursor: pointer; padding: 5px; font-size: 24px; }
        .control-btn:hover { color: #00aaff; }
        input[type="range"] { -webkit-appearance: none; appearance: none; background: transparent; cursor: pointer; }
        input[type="range"]::-webkit-slider-runnable-track { background: rgba(255, 255, 255, 0.3); height: 6px; border-radius: 3px; }
        input[type="range"]::-moz-range-track { background: rgba(255, 255, 255, 0.3); height: 6px; border-radius: 3px; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; margin-top: -5px; background-color: #00aaff; height: 16px; width: 16px; border-radius: 50%; }
        input[type="range"]::-moz-range-thumb { border: none; background-color: #00aaff; height: 16px; width: 16px; border-radius: 50%; }
        #progress-bar { flex-grow: 1; }
        #volume-slider { width: 100px; }
        .time-display { color: white; font-size: 14px; user-select: none; }

        /* Channel Grid Styles */
        .channel-buttons { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 20px; margin-top: 20px; }
        .channel-tile {
            background-color: #2a2a2e;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 2px solid transparent;
            min-height: 120px;
            position: relative; /* Needed for overlays */
        }
        .channel-tile:hover {
            transform: scale(1.05);
            background-color: #3c3c41;
        }
        .channel-tile img { width: 100%; max-height: 60px; object-fit: contain; margin-bottom: 10px; flex-grow: 1; }
        .channel-tile-name { font-size: 14px; color: #e0e0e0; text-align: center; font-weight: 500; }
        
        /* --- START: 2. Improved "Now Playing" Display --- */
        .channel-tile.active {
            border-color: #00aaff;
            background-color: #005c99;
            transform: scale(1.08);
            box-shadow: 0 0 25px rgba(0, 170, 255, 0.6);
        }
        .channel-tile.active::before {
            content: '‚ñ∂ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô';
            position: absolute;
            top: 8px;
            left: 8px;
            background-color: #00aaff;
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
            z-index: 2;
        }
        /* --- END: 2. Improved "Now Playing" Display --- */

        /* --- START: 3. "Play Icon" Hover Effect --- */
        .channel-tile .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            font-size: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0; /* Hidden by default */
            transition: opacity 0.2s ease-in-out;
            border-radius: 10px; /* Match the tile's inner curve */
            z-index: 1;
        }
        .channel-tile:hover .play-overlay {
            opacity: 1; /* Show on hover */
        }
        .channel-tile.active:hover .play-overlay {
            opacity: 0; /* Do not show overlay on the active tile */
        }
        /* --- END: 3. "Play Icon" Hover Effect --- */
        
    </style>
</head>
<body>
    <div class="container">
        <div class="player-wrapper">
            <video id="video" autoplay muted></video>
            <div class="custom-controls">
                <button id="play-pause-btn" class="control-btn">‚ñ∂Ô∏è</button>
                <input type="range" id="progress-bar" value="0" step="1">
                <div id="time-display" class="time-display">00:00 / 00:00</div>
                <button id="mute-btn" class="control-btn">üîä</button>
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
                <button id="fullscreen-btn" class="control-btn">‚õ∂</button>
            </div>
        </div>
        
        <div id="channel-buttons-container" class="channel-buttons"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
    // Custom Player Logic
    const video = document.getElementById('video');
    const playPauseBtn = document.getElementById('play-pause-btn');
    const progressBar = document.getElementById('progress-bar');
    const timeDisplay = document.getElementById('time-display');
    const muteBtn = document.getElementById('mute-btn');
    const volumeSlider = document.getElementById('volume-slider');
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    const playerWrapper = document.querySelector('.player-wrapper');

    function togglePlay() { video.paused ? video.play() : video.pause(); }
    function updatePlayButton() { playPauseBtn.textContent = video.paused ? '‚ñ∂Ô∏è' : '‚è∏Ô∏è'; }
    function formatTime(time) { const minutes = Math.floor(time / 60); const seconds = Math.floor(time % 60); return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`; }
    function updateProgress() { progressBar.value = (video.currentTime / video.duration) * 100 || 0; timeDisplay.textContent = `${formatTime(video.currentTime)} / ${formatTime(video.duration || 0)}`; }
    function setProgress() { video.currentTime = (progressBar.value / 100) * video.duration; }
    function toggleMute() { video.muted = !video.muted; }
    function updateMuteButton() { muteBtn.textContent = video.muted || video.volume === 0 ? 'üîá' : 'üîä'; }
    function setVolume() { video.volume = volumeSlider.value; }
    function toggleFullscreen() { if (!document.fullscreenElement) { playerWrapper.requestFullscreen().catch(err => alert(`Error: ${err.message}`)); } else { document.exitFullscreen(); } }

    playPauseBtn.addEventListener('click', togglePlay);
    video.addEventListener('play', updatePlayButton);
    video.addEventListener('pause', updatePlayButton);
    progressBar.addEventListener('input', setProgress);
    video.addEventListener('timeupdate', updateProgress);
    muteBtn.addEventListener('click', toggleMute);
    volumeSlider.addEventListener('input', setVolume);
    video.addEventListener('volumechange', () => { updateMuteButton(); volumeSlider.value = video.volume; });
    fullscreenBtn.addEventListener('click', toggleFullscreen);

    // Channel loading logic
    let hls, channels = {}, currentChannelId = null;
    const channelButtonsContainer = document.getElementById('channel-buttons-container');
    
    // --- START: JS Changes for UI improvements ---
    // Note: We no longer need variables for channelInfoContainer, channelLogo, etc.
    function createChannelButtons() {
        channelButtonsContainer.innerHTML = '';
        for (const channelId in channels) {
            const channel = channels[channelId];
            const tile = document.createElement('a');
            tile.className = 'channel-tile';
            tile.dataset.channelId = channelId;
            tile.onclick = () => loadChannel(channelId);
            
            const logoImg = document.createElement('img');
            logoImg.src = channel.logo;
            logoImg.alt = channel.name;

            const nameSpan = document.createElement('span');
            nameSpan.className = 'channel-tile-name';
            nameSpan.innerText = channel.name;
            
            // 3. Add the play icon overlay element
            const playOverlay = document.createElement('div');
            playOverlay.className = 'play-overlay';
            playOverlay.innerHTML = '&#9658;'; // Play symbol

            tile.appendChild(logoImg);
            tile.appendChild(nameSpan);
            tile.appendChild(playOverlay);
            
            channelButtonsContainer.appendChild(tile);
        }
    }
    
    function loadChannel(channelId) {
        if (!channels[channelId]) return;
        currentChannelId = channelId;
        const channel = channels[channelId];
        
        // We no longer need to update the separate info bar
        // channelInfoContainer.style.display = 'flex';
        // channelLogo.src = channel.logo;
        // channelNameElement.innerText = channel.name;

        updateActiveButton(); // This will now handle the "Now Playing" style

        if (hls) {
            hls.loadSource(channel.url);
            video.play();
        }
    }
    // --- END: JS Changes for UI improvements ---

    function updateActiveButton() {
        const tiles = channelButtonsContainer.querySelectorAll('.channel-tile');
        tiles.forEach(tile => tile.classList.toggle('active', tile.dataset.channelId === currentChannelId));
    }

    async function init() {
        try {
            const response = await fetch('channels.json');
            channels = await response.json();
        } catch (e) {
            alert("Fatal Error: Could not load channel data.");
            return;
        }
        if (Hls.isSupported()) {
            hls = new Hls();
            hls.attachMedia(video);
        }
        createChannelButtons();
        const firstChannelId = Object.keys(channels)[0];
        if (firstChannelId) {
            loadChannel(firstChannelId);
        }
    }

    document.addEventListener("DOMContentLoaded", init);
    </script>
</body>
</html>
